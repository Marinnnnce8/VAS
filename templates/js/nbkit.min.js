/*! NBkit | @version 1.3.5 | @author NB Communication Ltd <info@nbcommunication.com> | @copyright 2021 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("uikit")):"function"==typeof define&&define.amd?define("nbkit",["uikit"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).NBkit=e(t.UIkit)}(this,(function(t){"use strict";var e={duration:256,offset:0,ukAlert:{animation:!0,duration:256},ukNotification:{status:"primary",pos:"top-right",timeout:4096}};function i(e){if(Array.isArray(e))return e.join(" ");if(t.util.isPlainObject(e)){const i=[];let n;for(let l in e)if(t.util.hasOwn(e,l)){if(n=e[l],t.util.isPlainObject(n))break;t.util.isBoolean(n)&&(n=String(n)),l=t.util.hyphenate(l),i.push(`${l}: ${n}`)}return Object.keys(e).length===i.length?i.join("; "):JSON.stringify(e)}return String(e)}function n(t,e){try{return r(t=atob(t),"",!1,e)}catch(t){return""}}function l(e,i=""){return Array.isArray(e)&&(e=e.join(i)),t.util.isPlainObject(e)&&(e=JSON.stringify(e)),"string"==typeof e?btoa(e):""}function r(e,i,l=!1,r=""){if(t.util.isPlainObject(e))return e;let s;if(t.util.isNode(e)&&(s=e,e=i?t.util.data(s,i):""),l)return s&&["","data-"].forEach((e=>{let n=e+i;t.util.hasAttr(s,n)&&t.util.removeAttr(s,n)})),e?n(e,r):{};if(r&&t.util.includes(e,r))e=e.split(r);else try{const i=t.util.parseOptions(e);t.util.isEmpty(i)||(e=i)}catch(n){i&&t.util.includes(e,i)&&(e=e.split(i))}return e}const s="localStorage"in window&&"sessionStorage"in window;function o(t){return/<[a-z][\s\S]*>/i.test(t)}function a(t){return o(t)?t:("<"===t.substr(0,1)?"":"<")+t+(">"===t.substr(t.length-1,1)?"":">")}function u(t){return"profiler"in window?profiler.start(t):null}function c(t){return"profiler"in window?profiler.stop(t):0}function f(t,e="."){return/.*[.,\/!?\^&\*;:{}=]$/.test(t)||(t+=e),t}function h(e){return t.util.isPlainObject(e)&&!t.util.isEmpty(e)?"?"+Object.keys(e).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`)).join("&"):""}function d(i,n){t.util.isUndefined(i)||t.util.isUndefined(n)||i in e&&(t.util.isPlainObject(e[i])&&t.util.isPlainObject(n)?e[i]=t.util.assign({},e[i],n):e[i]=n)}function g(e="",i={}){if(u("NBkit.ajax"),t.util.isPlainObject(e)&&(i=e,e=""),e||(e=window.location.href),t.util.isPlainObject(i)||(i={}),e+=(t.util.includes(e,"?")?"&":"?")+"nc=1",t.util.includes(e,"#")){let t=e.split("#"),i=t[1].split("?");e=`${t[0]}${i.length>1?"?"+i[1]:""}#${i[0]}`}return(i=t.util.assign({headers:{},method:"GET"},i)).headers["X-Requested-With"]="XMLHttpRequest",new t.util.Promise(((n,l)=>{t.util.ajax(e,i).then((t=>{c("NBkit.ajax"),n(t)}),(t=>{c("NBkit.ajax"),l(t)}))}))}function p(e,i=new FormData,n=""){if(e instanceof HTMLFormElement)return new FormData(e);let l=i;for(let i in e)t.util.hasOwn(e,i)&&(t.util.isPlainObject(e[i])?p(e[i],l,i):l.append(n?`${n}[${i}]`:i,e[i]));return l}function m(){let e={},n="",l=!1;const r=arguments;for(let i,s=0;s<r.length;s++)if(i=r[s],t.util.isBoolean(i))l=i;else if(t.util.isString(i)&&i)n=i;else if(Array.isArray(i)&&i.length){"class"in e||(e.class=[]),Array.isArray(e.class)||(e.class=[e.class]);for(let t=0;t<i.length;t++)e.class.push(i[t]);n="div"}else t.util.isPlainObject(i)&&(e=t.util.assign(e,i));const s=[];let o;for(let r in e)if(t.util.hasOwn(e,r))switch(o=e[r],r){case"tag":n||(n=o);break;case"close":l=t.util.toBoolean(o);break;default:!1!==o&&(r&&(r=t.util.hyphenate(r)),""===o||t.util.isBoolean(o)?s.push(r):(o=i(o),s.push(r?`${r}="${o}"`:o)))}let a=s.join(" ");return a=a?" "+a:"",n&&(n=n.replace(/<|>|\//gi,"")),n?`<${n+a}>`+(l?`</${n}>`:""):a}function b(e,i="",n={}){let l=!1;return t.util.isBoolean(n)?(l=n,n={}):t.util.isPlainObject(n)||(n={class:n}),t.util.isPlainObject(e)&&("href"in e?e=(n=e).href:"url"in n?(i=e[i||"title"],e=e.url):(n=e,e="#")),null===i?i=e:t.util.isPlainObject(i)?(n=i,i=""):t.util.isBoolean(i)&&(l=i,i=""),t.util.includes(e,"://")&&(l=!0),n.href=e,"target"in n||(n.target=!!l&&"_blank"),"rel"in n||(n.rel=!!l&&"noopener"),k(i,n,"a")}function k(e,i="",n=""){if(u("NBkit.wrap"),!i&&!n&&t.util.isString(e))return e;if((Array.isArray(i)||t.util.isPlainObject(i))&&(i=m(i,n)),t.util.isString(i)&&(t.util.startsWith(i,"uk-")||t.util.startsWith(i,"nb-"))&&(i=`<div class="${i}">`),i=a(i),Array.isArray(e)){let t=i.split(">")[0].replace("<","");e=e.join(`</${t.split(" ")[0]}><${t}>`)}let l;return t.util.includes(i,"></")&&!/=["|'][^"|']+(><\/)[^"|']+["|']/g.test(i)?(l=i.split("></"),i=`${l[0]}>${e}</${l.splice(1).join("></")}`):(l=i.split(">",2),i=2===l.length?`${i}${e}</${l[0].split(" ")[0].replace(/</gi,"")}>`:e),c("NBkit.wrap"),i}function $(i){if(t.util.isUndefined(i))return;Array.isArray(i)&&(i=i.join("<br>"));let n="primary",l={},r=!1,s={class:["uk-alert"]};const a=arguments;for(let e,i=1,o=0;i<a.length;i++)if(e=a[i],t.util.isBoolean(e))r=e;else if(t.util.isNumeric(e))e=t.util.toNumber(e),1==i?n=e<100||e>=400?"danger":"success":l.duration=e;else if(t.util.isString(e))n=e;else if(Array.isArray(e))for(;o<e.length;o++)s.class.push(e[o]);else if(t.util.isPlainObject(e))if("animation"in e)l=t.util.assign(l,e);else{if("class"in e){for(Array.isArray(e.class)||(e.class=e.class.split(" "));o<e.class.length;o++)s.class.push(e.class[o]);delete e.class}s=t.util.assign(s,e)}return"danger"==n&&(s.role="alert"),s.class.push("uk-alert-"+n),s.dataUkAlert=!r&&!Object.keys(l).length||t.util.assign({},e.ukAlert,l),k((r?m({type:"button",class:"uk-alert-close",title:"close",dataUkClose:!0},"button",!0):"")+k(i,o(i)?"":"p"),s,"div")}function y(){let e={},i={};const n=arguments;for(let l,r=1;r<n.length;r++)l=n[r],t.util.isNumeric(l)?i.ratio=t.util.toNumber(l):t.util.isString(l)?e.class=[l]:Array.isArray(l)?e.class=l:t.util.isPlainObject(l)&&(e=t.util.assign(e,l));return e.dataUkSpinner=!Object.keys(i).length||i,m(e,"span",!0)}function j(e,i=!0){let n,l="";i?(t.util.attr(e,"disabled",!0),n=y(.467),e.children.length?(t.util.addClass(e.children[0],"uk-hidden"),t.util.after(e.children[0],n)):(l=t.util.html(e),t.util.html(e,t.util.html(e).replace(l,n)),e.dataset.label=l)):(t.util.removeAttr(e,"disabled"),n=t.util.$(".uk-spinner",e),"label"in e.dataset&&(l=e.dataset.label,delete e.dataset.label),n&&(l?t.util.before(n,l):t.util.removeClass(e.children[0],"uk-hidden"),t.util.remove(n)))}function S(e,i,n){const l="NBkit.loadS"+("script"===e?"cript":"tyle");return u(l),new t.util.Promise(((r,s)=>{const o=document.createElement(e);let a;for(let e in i)t.util.hasOwn(i,e)&&(a=i[e],"element"===e?n=a:o.setAttribute(e,a));o.onload=()=>{c(l),r(o)},o.onerror=t=>{c(l),s(t)},t.util.append(n,o)}))}function v(e){return S("script",t.util.isPlainObject(e)?e:{src:e,async:!0},arguments.length>1?arguments[1]:"body")}function O(e){const i=t.util.isPlainObject(e)?e:{href:e};return i.rel="stylesheet",S("link",i,arguments.length>1?arguments[1]:"head")}var N=Object.freeze({__proto__:null,ajax:g,objectToFormData:p,post:function(t,e={}){return g(t,{data:p(e),method:"POST"})},buttonLoading:j,getPreviousSibling:function(t,e=""){let i=t.previousElementSibling;if(!e)return i;for(;i;){if(i.matches(e))return i;i=i.previousElementSibling}},loadAsset:S,loadAssets:function(e){let i=[];for(let n,l=0;l<e.length;l++)n=e[l],i.push("js"===(t.util.isPlainObject(n)?n.src?n.src:n.href?n.href:"":n).substr(-2)?v(n):O(n));return t.util.Promise.all(i)},loadScript:v,loadStyle:O,attrs:m,link:b,wrap:k,ukAlert:$,ukNotification:function(i){if(t.util.isUndefined(i))return;if(t.util.isString(i)&&(i={message:i}),!t.util.isPlainObject(i))return;const n=arguments;for(let e,l=1;l<n.length;l++)e=n[l],t.util.isNumeric(e)?i.timeout=t.util.toNumber(e):t.util.isString(e)?e.includes("-")?i.pos=e:i.status=e:t.util.isPlainObject(e)&&(i=t.util.assign(e,i));t.util.isUndefined(i.message)||t.notification(t.util.assign({},e.ukNotification,i))},ukSpinner:y,attrValue:i,base64Decode:n,base64Encode:l,data:r,debounce:function(t,i=e.duration,n=!1){let l;return function(){const e=this,r=arguments,s=()=>{l=null,n||t.apply(e,r)},o=n&&!l;clearTimeout(l),l=setTimeout(s,i),o&&t.apply(e,r)}},getClassName:function(e){if(t.util.isPlainObject(e))if("$options"in e)e=e.$options.name;else{const t=["name","title"];for(let i,n=0;n<t.length;n++)if(i=t[n],i in e){e=e[i];break}}return t.util.isString(e)?t.util.hyphenate(e).replace(/\s+/g,"-"):""},hasStorage:s,isTag:o,makeTag:a,profilerStart:u,profilerStop:c,punctuateString:f,queryString:h,setOption:d}),w={args:"msgConfirm",props:{callback:String,msgConfirm:String},data:{button:null,captcha:null,scroller:null},beforeConnect:function(){u("NBkit.Form.beforeConnect");const e=this.$el,i=t.util.$("input[type=hidden]._post_token",e);if(i){const e=e=>{t.util.attr(i,"name",e.tokenName),t.util.attr(i,"value",e.tokenValue)};let n=s?sessionStorage.getItem("CSRF"):"";if(n)try{e(JSON.parse(n))}catch(t){}else g({headers:{"PW-Session-CSRF":1},responseType:"json"}).then((t=>{n=t.response,e(n),s&&sessionStorage.setItem("CSRF",JSON.stringify(n))}),t.util.noop)}this.scroller=t.util.$(m({hidden:!0},"div",!0)),t.util.append(e,this.scroller),c("NBkit.Form.beforeConnect")},connected:function(){u("NBkit.Form.connected");const i=this,n=this.$el;setTimeout((function(){t.util.trigger(n,"onload",i),c("NBkit.Form.connected")}),e.duration)},events:{submit:function(i){u("NBkit.Form.events.submit"),i.preventDefault(),i.stopPropagation();const n=this.$el;let l=[];const r=t.util.$$(".nb-form-errors",n);if(r.length&&t.util.remove(r),t.util.$$("input[required], select[required], textarea[required]",n).forEach((e=>{t.util.attr(e,"aria-invalid",!1),t.util.remove(t.util.$(".nb-form-error",e.closest(".nb-form-content")))})),t.util.$$("input[required], select[required], textarea[required]",n).forEach((i=>{if(!i.validity.valid){t.util.attr(i,"aria-invalid",!0);let r=t.util.attr(i,"title");r||(r=i.validationMessage);const s=i.id,o=s?t.util.$(`label[for=${s}]`,n):null;r=f(r),l.push(b("#"+(s||n.id),(o?o.innerHTML+": ":"")+r,{class:"uk-link-reset",dataUkScroll:{duration:e.duration,offset:e.offset}}));const a=k(r,"uk-text-danger nb-form-error"),u=t.util.$("[role=alert]",i.closest(".nb-form-content"));u?t.util.append(u,a):t.util.before(i,a)}})),l.length)return t.util.trigger(n,"invalid",this),this.reset(),t.util.before(t.util.$(".uk-grid",n),$(k(k(l,"li"),"ul"),"danger",["nb-form-errors"])),UIkit.scroll(this.scroller,{duration:e.duration,offset:e.offset}).scrollTo(n),t.util.on('.nb-form-errors a[href^="#"]',"click",(function(){t.util.$(t.util.attr(this,"href")).focus()})),!1;if(this.button=t.util.$("button[type=submit]",n),this.msgConfirm){const t=this;UIkit.modal.confirm(this.msgConfirm).then((()=>t.send()),(()=>!1))}else this.send();c("NBkit.Form.events.submit")}},methods:{error:function(e){this.reset(),UIkit.modal.alert($(e,"danger")),t.util.trigger(this.$el,"error",this)},reset:function(){this.button&&j(this.button,!1),this.captcha&&grecaptcha.reset()},send:function(){u("NBkit.Form.send");const i=this.$el,n=t.util.attr(i,"method");j(this.button),this.captcha=t.util.$(".g-recaptcha",i),t.util.trigger(i,"beforeSend",this);const l=this;g(i.action,{data:new FormData(i),method:n||"POST"}).then((n=>{const{response:r}=n,s=parseInt(n.getResponseHeader("NB-Form-State"));if(l.callback&&l.callback in window)window[l.callback].call(l,n);else if(200===s){t.util.remove(this.button),this.captcha&&t.util.remove(this.captcha),t.util.$$("input, select, textarea",i).forEach((e=>{t.util.attr(e,"disabled",!0)}));const n=t.util.$(".uk-grid",i);t.util.before(n||i,$(r,s)),UIkit.scroll(l.scroller,{duration:e.duration,offset:e.offset}).scrollTo(i),t.util.trigger(i,"complete",l)}else l.error(r);c("NBkit.Form.send")}),(t=>{l.error(t),c("NBkit.Form.send")}))}}},A={props:{callback:String,container:String,filter:String,message:String,more:String,url:String},data:{container:".nb-items-container",filter:".nb-items-filter",init:0,loading:".nb-items-loading",message:".nb-items-message",more:".nb-items-more",url:window.location.href},beforeConnect:function(){const e=t.util.$("[data-cursor]",this.$el);e&&0===parseInt(e.innerText)&&(e.innerText=t.util.$$("> div",t.util.$(this.container,this.$el)).length)},connected:function(){const e=t.util.$(this.more+" button",this.$el);e&&!t.util.hasClass(e.closest(this.more),"uk-hidden")&&(this.init=t.util.$$("> div",t.util.$(this.container,this.$el)).length,this.init&&(t.util.trigger(e,"click"),this.init=0))},events:[{name:"click",delegate:function(){return this.more+" button"},handler:function(t){this.request(!0)}},{name:"click",delegate:function(){return this.filter+" [data-filter]:not(.uk-active)"},handler:function(e){const i=e.target;t.util.removeClass(t.util.$$(".uk-active",i.closest(this.filter)),"uk-active"),t.util.addClass(i,"uk-active"),this.setUrl(r(i,"filter")),this.request()}},{name:"change",delegate:function(){return this.filter+" form select"},handler:function(e){const i=e.target.closest("form");t.util.$("button",i)||t.util.trigger(i,"submit")}},{name:"submit reset",delegate:function(){return this.filter+" form"},handler:function(e){const i=e.target,n={};if("submit"===e.type){e.preventDefault(),e.stopPropagation();const s=Array.from(new FormData(i).entries()),o={};if(t.util.isArray(s))for(let l,a,u,c,f,h,d,g=0;g<s.length;g++)if(a=s[g][1],a){if(u=s[g][0],c=t.util.$$(`[name="${u}"]`,i),f=c.length,f)if(1===f)h=c[0];else for(l=0;l<f;l++)if((e=c[l]).value===a){h=e;break}if(h)if(t.util.hasAttr(h,"data-selectors"))for(d=r(h,"selectors"),l=0;l<d.keys.length;l++)o[d.keys[l]]=d.values[h.value][l];else t.util.hasAttr(h,"data-selector")?o[u+t.util.data(h,"selector")]=a:n[u]=a}t.util.isEmpty(o)||(n.selectors=l(o))}else t.util.$$(".uk-input",i).forEach((e=>{t.util.attr(e,"value","")})),t.util.$$(".uk-select",i).forEach((e=>{let i=t.util.$$("option",e);t.util.removeAttr(i,"selected"),t.util.attr(i[0],"selected",!0)}));this.setUrl(n),this.request()}}],methods:{request:function(e=!1){u("NBkit.Items.request");const i=this.$el,n=t.util.$$(this.container,i),l=n.length-1;if(-1===l)return void c("NBkit.Items.request");const r=t.util.$$(this.loading,i),s=t.util.$$(this.more,i),o=s.length?t.util.$$(this.more+" button",i):[];e||(t.util.html(n,""),r.length&&t.util.removeClass(r,"uk-hidden"),s.length&&t.util.removeClass(s,"uk-hidden")),t.util.remove(".uk-alert",i),o.length&&o.forEach((t=>j(t)));const a=this;g(this.url,{headers:{"NB-Items-Init":this.init,"NB-Items-LoadMore":e},responseType:l?"json":""}).then((e=>{const u=parseInt(e.getResponseHeader("NB-Items-Cursor")),f=parseInt(e.getResponseHeader("NB-Items-Total"));if(r.length&&t.util.addClass(r,"uk-hidden"),o.length&&o.forEach((t=>j(t,!1))),l)for(let i=0;i<l+1;i++)t.util.append(n[i],e.response[i]);else t.util.append(n[0],e.response);const h=t.util.$(a.message,i);if(h){let e;const i={cursor:u,total:f};Object.keys(i).forEach((n=>{e=t.util.$(`[data-${n}]`,h),e&&(e.innerText=i[n])}))}(s.length&&f-u<=0||204===e.status)&&t.util.addClass(s,"uk-hidden"),t.util.trigger(i,"complete",a),a.callback&&a.callback in window&&window[a.callback].call(a,e),c("NBkit.Items.request")}),(e=>{t.util.trigger(i,"error",a),t.util.html(n,""),t.util.before(n,$(e,500)),s.length&&t.util.addClass(s,"uk-hidden"),c("NBkit.Items.request")}))},setUrl:function(t={}){this.url=this.url.split("?")[0]+h(t)}}},B={args:"text",props:["text"],beforeConnect:function(){u("NBkit.Obfuscate.beforeConnect");const e=n(this.text);let l=e;if(t.util.isPlainObject(e)){l=e.text;for(let n in e)t.util.hasOwn(e,n)&&"text"!==n&&("href"!==n||l||(l=e[n]),t.util.attr(this.$el,n,i(e[n])))}this.$el.innerHTML=l,t.util.removeAttr(this.$el,"data-"+this.$name),c("NBkit.Obfuscate.beforeConnect")}},P=Object.freeze({__proto__:null,nbForm:w,nbItems:A,nbObfuscate:B});const C=t.util.noop;return C.options=e,C.util=N,C.version="1.3.5",t.util.each(P,((t,e)=>{window.UIkit.component(e,t)})),window.nb=N,window.uk=t.util,u("NBkit.init"),t.util.ready((()=>{const e=t.util.$("header");e&&d("offset",e.offsetHeight);const i=t.util.$$("a[target=_blank]");if(i){let e;i.forEach((i=>{e=t.util.attr(i,"rel"),e=t.util.isString(e)?e.split(" "):[],t.util.includes(e,"noopener")||e.push("noopener"),t.util.attr(i,"rel",e.join(" "))}))}c("NBkit.init")})),C}));
